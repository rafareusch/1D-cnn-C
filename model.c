#include <stdio.h>
#include <stdlib.h>
#include <math.h>

#include "params/biasout0.h"
#include "params/biasout3.h"
#include "params/biasout6.h"
#include "params/linear_biasout1.h"
#include "params/linear_biasout4.h"
#include "params/weightout0.h"
#include "params/weightout3.h"
#include "params/weightout6.h"
#include "params/linear_weightout1.h"
#include "params/linear_weightout4.h"



#define INPUT_SIZE 120
#define NUM_FILTERS 64
#define KERNEL_SIZE 5
#define CONV0_INPUT_SIZE 120 
#define CONV3_INPUT_SIZE 116
#define CONV6_INPUT_SIZE 112 
#define FC1_OUTPUT_SIZE 128
#define FC2_OUTPUT_SIZE 5
// #define DEBUG 0

main(){

    printf("Boot... ");


    // Create Fake input
    
    int i = 0;
    // for (i = 0; i < INPUT_SIZE; i++)
    // {
    //     input_vector[i] = i+1;
    // }

    // A
    //float input_vector[INPUT_SIZE] = {141,807,-944,3,0,0,-2,-21,4,22,-128,225,-161,34,0,0,-2,-288,109,-123,1305217456,-7049400371,-8487393888,37,0,-2,0,-234,47,-271,284,-639,-153,36,3,0,-2,192,203,-215,141,807,-944,3,2,0,-2,-22,4,22,-128,225,-161,34,2,-2,-2,-290,110,-125,1313073959,-7063750507,-8471064711,37,0,-2,0,-233,47,-269,283,-639,-153,36,2,0,-2,192,203,-216,142,807,-944,3,0,0,-2,-20,5,23,-128,225,-161,34,2,-2,-2,-289,110,-126,1285074981,-7027811982,-8514078134,37,0,-2,0,-232,46,-270,283,-639,-152,36,3,-2,0,196,204,-213};

    // B
    //float input_vector[INPUT_SIZE] = {122 ,275 ,-39 ,18 ,-37 ,-5 ,-41 ,-30 ,66 ,-161 ,347 ,-605 ,-146 ,17 ,252 ,-225 ,-87 ,111 ,95 ,89 ,-1160433249 ,2228811147 ,1318602804 ,9 ,47 ,-11 ,-28 ,21 ,-11 ,92 ,-146 ,413 ,-116 ,32 ,18 ,-2 ,2 ,-104 ,-175 ,-238,122 ,274 ,-375 ,18 ,-31 ,-5 ,-38 ,-30 ,70 ,-162 ,344 ,-563 ,-147 ,16 ,239 ,-21 ,-84 ,97 ,93 ,86 ,-162177764 ,2390908162 ,1280091646 ,9 ,45 ,-11 ,-28 ,22 ,-15 ,89 ,-147 ,419 ,-118 ,32 ,13 ,85 ,7 ,-125 ,-173 ,-224,122 ,271 ,-343 ,19 ,-26 ,-3 ,-41 ,-40 ,78 ,-166 ,336 ,-482 ,-149 ,17 ,262 ,-204 ,-66 ,87 ,74 ,127 ,-1077852261 ,2278780653 ,1317892057 ,9 ,47 ,-11 ,-26 ,21 ,-10 ,90 ,-149 ,448 ,-123 ,28 ,-31 ,172 ,43 ,-123 ,-115 ,-215};

    // C
    //float input_vector[INPUT_SIZE] = {151,708,-93,3,3,2,-5,-19,3,22,835,16,112,32,-2,-6,11,-281,97,-107,-6670784252,-1829881388,8699058939,3,5,-5,-13,-5,-17,21,165,468,-175,28,32,-61,-3,-202,4,-181,147,709,-93,3,2,2,-5,-17,6,22,836,159,112,33,-5,3,7,-289,98,-96,-7559694104,-1030816085,8042261421,3,5,-2,-15,-3,-20,21,166,467,-174,27,24,-27,-16,-195,-16,-184,136,695,-93,3,-3,2,-7,-20,3,19,829,157,112,32,-2,3,-3,-284,95,-108,-5310141555,-2761788319,9580016792,3,8,2,-1,-7,-13,21,163,47,-178,26,-42,71,-41,-161,-29,-193};

    // D
    //float input_vector[INPUT_SIZE] = {122,253,-569,20,-43,-2,-44,-37,73,-173,116,-171,-29,45,14,-53,41,405,-94,-156,-247543209,2629122477,1306666034,9,51,-5,-25,21,-2,78,138,388,140,33,43,-271,-11,-110,246,-174,122,252,-564,20,-43,-2,-46,-38,73,-173,111,-157,-193,43,175,-1,-64,407,-85,-76,-2215576361,1669288047,1402376183,10,59,8,-36,15,-2,89,147,453,154,26,37,-222,-7,-128,122,-178,122,251,-563,19,-43,-2,-49,-40,73,-172,108,-143,-131,42,196,-128,-23,403,-68,-67,147220349,3573545474,1181746363,10,5,-6,-34,31,13,82,151,474,159,25,32,-17,-1,-114,107,-191};

    // E
    //float input_vector[INPUT_SIZE] = {-65,673,-922,1,21,-2,-51,-7,1,2,168,-217,-108,49,116,-32,49,-31,-93,-472,6381505346,9062384095,1602504362,23,-22,83,-26,148,112,30,144,327,131,39,-3,302,102,-103,340,-153,-121,682,-923,1,21,-2,-52,-11,4,3,168,-232,-107,49,135,-43,51,-17,-101,-466,6582322645,8854618075,1632116064,25,-24,55,-2,162,128,34,143,305,127,42,-1,289,87,-122,357,-161,-169,695,-923,1,19,-2,-54,-11,-2,8,168,-251,-106,48,156,-53,51,-12,-101,-456,697177809,8410213395,1805760126,21,-22,24,-8,166,143,40,142,286,124,41,-14,268,69,-124,350,-141};

    // 0
    //float input_vector[INPUT_SIZE] =  {-1.0038787126541138,0.34741517901420593,-0.8740308284759521,-1.0737779140472412,-0.4859677255153656,-0.8803093433380127,0.9517751932144165,0.026978855952620506,-0.5060392618179321,0.45808035135269165,-2.0052154064178467,0.8837242722511292,-2.248081922531128,0.8070645928382874,-1.2567771673202515,0.704573929309845,-0.4066600203514099,-0.011423859745264053,0.2784796357154846,-0.5233466029167175,-0.15717202425003052,-1.6086519956588745,-1.0521975755691528,2.275770902633667,-3.0228865146636963,-0.08214741200208664,-2.1169779300689697,-0.10678626596927643,-0.10829659551382065,0.056413684040308,-0.05115719139575958,-2.6518070697784424,-1.6590017080307007,0.12775994837284088,1.4269073009490967,0.20159955322742462,-1.1396721601486206,-0.19727887213230133,-0.03069528192281723,-0.08621051162481308,-1.0039373636245728,0.3473369777202606,-0.8739429116249084,-1.0736680030822754,-0.5533527731895447,-0.915244996547699,0.9417234063148499,0.1235293373465538,-0.5060564279556274,0.4580004811286926,-2.005117416381836,0.8836329579353333,-2.2476847171783447,0.8071296215057373,-1.26213538646698,0.7044941782951355,-0.39937153458595276,-0.011385926976799965,0.27842313051223755,-0.5232911705970764,-0.15316279232501984,-1.6181915998458862,-1.0470486879348755,2.2753963470458984,-3.0368857383728027,-0.0697699636220932,-2.1076443195343018,-0.10678558796644211,-0.10829322785139084,0.05642177164554596,-0.05117069557309151,-2.651226043701172,-1.6684982776641846,0.12774482369422913,1.4046051502227783,0.19652371108531952,-1.161249041557312,-0.21260765194892883,-0.024256059899926186,-0.09760637581348419,-1.0038366317749023,0.3472588360309601,-0.8738548755645752,-1.0735582113265991,-0.5195406675338745,-0.9152047038078308,0.9416272640228271,0.027155226096510887,-0.5060735940933228,0.4579198658466339,-2.0050222873687744,0.8835416436195374,-2.2472896575927734,0.8071947693824768,-1.251015305519104,0.6953134536743164,-0.3846500515937805,-0.021383395418524742,0.3018587827682495,-0.5232425928115845,-0.154278963804245,-1.614141821861267,-1.049086332321167,2.275022029876709,-3.050874948501587,-0.06977314502000809,-2.1257128715515137,-0.10678116977214813,-0.1083034798502922,0.056429408490657806,-0.05025862529873848,-2.6506454944610596,-1.6683058738708496,0.1277245283126831,1.4044517278671265,0.19644750654697418,-1.1539241075515747,-0.19709637761116028,-0.024270914494991302,-0.09760433435440063};
    //float input_vector[INPUT_SIZE] =  {0.8220906853675842,0.6887679696083069,0.13452985882759094,0.7344822883605957,-0.4859677255153656,1.1142269372940063,-0.8202980160713196,0.7986599802970886,1.155547022819519,-0.2049098014831543,-0.7980582118034363,1.2129043340682983,-1.3342593908309937,0.2368556410074234,-1.163390874862671,-0.860928475856781,0.6181533932685852,-0.08666091412305832,-0.06212369352579117,1.2120449542999268,0.17204266786575317,-0.04863457381725311,1.4202200174331665,-0.9496394395828247,0.3506518304347992,-0.4784089922904968,0.6879802346229553,-0.21284277737140656,0.2851324677467346,0.12200996279716492,-0.758293867111206,0.34781408309936523,-1.9109158515930176,1.6193383932113647,-2.111597776412964,-1.9419010877609253,0.5294687747955322,-0.21269553899765015,-0.05004461109638214,-0.2001984715461731,0.8381538987159729,0.7021339535713196,0.1331855207681656,0.7345734238624573,-0.6208197474479675,1.0792503356933594,-0.7706200480461121,0.7988007068634033,0.8999127149581909,-0.2879225015640259,-0.8062553405761719,1.180223822593689,-1.3311532735824585,0.33193719387054443,-1.2017107009887695,-0.9066125750541687,0.5438644289970398,0.3748362958431244,-0.35581687092781067,0.45286813378334045,-0.3016016185283661,-1.194451928138733,1.2161260843276978,-0.9496102333068848,0.14270789921283722,-0.6393964290618896,0.6331572532653809,-0.13992825150489807,-0.23943622410297394,-0.05727856233716011,-0.7240628004074097,0.44736483693122864,-1.8622647523880005,1.0226922035217285,-1.9843392372131348,-1.5573641061782837,0.5150599479675293,0.85123610496521,-0.43381741642951965,-0.16029974818229675,0.8382810354232788,0.7020784616470337,0.13352128863334656,0.7346644997596741,-0.5870123505592346,1.1142477989196777,-0.7906314134597778,0.7024831771850586,0.899907112121582,-0.3295117914676666,-0.7979560494422913,1.163838505744934,-1.3210420608520508,0.33198392391204834,-1.1905922889709473,-0.9159049987792969,0.5958316326141357,0.4300501048564911,-0.41460976004600525,0.43483680486679077,-0.5001169443130493,-0.9535544514656067,1.3065370321273804,-0.9495810270309448,0.187384232878685,-0.701315701007843,0.6422894597053528,-0.14655235409736633,-0.28862544894218445,-0.01354009285569191,-0.7157478332519531,0.46161332726478577,-1.8426834344863892,1.02267324924469,-2.001049280166626,-1.4575997591018677,0.5584543347358704,0.6972430348396301,-0.45318272709846497,-0.11470252275466919};


    //float input_vector[INPUT_SIZE] =  {0.9495802521705627,1.1585195064544678,0.10921342670917511,1.1219666004180908,-1.093135118484497,1.3591699600219727,-1.0194073915481567,-1.998684287071228,-0.8894822597503662,-1.2822686433792114,1.5557610988616943,-2.0169713497161865,0.9755251407623291,0.2368556410074234,1.616225004196167,-0.25111064314842224,1.6132620573043823,-1.36569082736969,0.807002067565918,0.01896330714225769,-0.8764784336090088,0.7590001821517944,1.3787723779678345,-0.4609408676624298,0.6627413034439087,-1.0728013515472412,1.1265404224395752,0.29755425453186035,0.23595383763313293,-0.057286519557237625,0.5291761755943298,-0.17676421999931335,0.8213835954666138,0.028321389108896255,1.1001908779144287,0.41644927859306335,-1.024060606956482,-0.28977876901626587,-0.06939394026994705,-0.20589786767959595,0.949708878993988,1.1584932804107666,0.10944388061761856,1.1220537424087524,-1.160555362701416,1.4291619062423706,-1.0493736267089844,-2.0469858646392822,-0.8895025849342346,-1.365366816520691,1.4594839811325073,-2.072498083114624,1.0905077457427979,0.1418602019548416,1.5448634624481201,-0.30586087703704834,1.6356415748596191,-1.3656716346740723,0.8539372086524963,-0.03521149232983589,-1.0206806659698486,0.5447385907173157,1.2941595315933228,-0.3632453680038452,0.5587295293807983,-1.1966396570205688,1.1265015602111816,0.31081193685531616,0.2687428593635559,-0.05727856233716011,0.531015157699585,-0.1837242841720581,0.8214015960693359,0.028306223452091217,1.0391308069229126,0.4213811159133911,-1.0095142126083374,-0.16635356843471527,-0.06617966294288635,-0.17169854044914246,0.9498375654220581,1.1584669351577759,0.11009394377470016,1.1221407651901245,-1.1942574977874756,1.429162859916687,-1.0295636653900146,-1.9988285303115845,-0.889522910118103,-1.282718539237976,1.2119879722595215,-2.1280205249786377,1.3469995260238647,-0.14322690665721893,1.314216136932373,-0.2331852912902832,1.628308653831482,-1.3355563879013062,0.9478550553321838,-0.3967038094997406,-0.8113653063774109,0.6303162574768066,1.4544851779937744,-0.36328956484794617,0.6033074259757996,-1.0356616973876953,1.172137975692749,0.28430214524269104,0.10480430722236633,-0.02228628657758236,0.5328543186187744,-0.19636650383472443,0.8214195370674133,0.028285782784223557,1.0555955171585083,0.4363093376159668,-1.0021944046020508,0.08045721054077148,-0.08231913298368454,-0.05770856514573097};
    // float input_vector[INPUT_SIZE] =  {0.9655165076255798,1.1406241655349731,0.10091467946767807,1.1219666004180908,-1.1605981588363647,1.3941618204116821,-1.0194073915481567,-1.7575339078903198,-0.8894822597503662,-1.240831732749939,1.7207485437393188,-0.4264776110649109,0.308378666639328,1.1872038841247559,2.3578221797943115,-0.3785352408885956,0.9968888163566589,-1.1750901937484741,0.8304919600486755,-0.07142166048288345,-0.35604575276374817,1.1338937282562256,1.5052376985549927,-0.36320117115974426,0.8559395670890808,-0.6641566157341003,1.1722238063812256,-0.0007297436241060495,-0.5017256140708923,0.22696399688720703,-1.3589897155761719,1.9862327575683594,-1.0515011548995972,-0.36943286657333374,-0.9376336932182312,-0.37299853563308716,-0.9084491729736328,0.5427202582359314,-0.7175965309143066,-0.4110761880874634,0.949708878993988,1.1450709104537964,0.0993589386343956,1.1220537424087524,-1.1268218755722046,1.3591796159744263,-1.009551763534546,-1.9987521171569824,-0.8895025849342346,-1.2410463094711304,1.6794586181640625,-0.6156176328659058,0.41361987590789795,0.9972066283226013,2.2040412425994873,-0.39688387513160706,1.1751642227172852,-1.1951318979263306,0.7952112555503845,-0.12559661269187927,-0.38866421580314636,1.1795827150344849,1.4828048944473267,-0.4609728455543518,0.8558878302574158,-0.6889291405677795,1.1265015602111816,0.17161276936531067,-0.3050076961517334,0.04767559468746185,-1.3867735862731934,2.2596142292022705,-1.0901051759719849,-0.36944815516471863,-0.9377534985542297,-0.23320378363132477,-0.77829909324646,0.6662197709083557,-0.5563633441925049,-0.1318027675151825,0.9498375654220581,1.1450436115264893,0.09906312823295593,1.1221407651901245,-1.1942574977874756,1.429162859916687,-1.0295636653900146,-1.9988285303115845,-0.889522910118103,-1.2412747144699097,1.6381731033325195,-0.7982398867607117,0.5328545570373535,0.6171104311943054,1.951404333114624,-0.3151116669178009,1.2494862079620361,-1.1951104402542114,0.8656373023986816,-0.5232425928115845,-0.6093177795410156,0.9201040267944336,1.518348217010498,-0.4610047936439514,0.7369970679283142,-0.8622971177101135,1.144732117652893,0.22464537620544434,-0.15748220682144165,0.012698468752205372,-1.4515807628631592,2.486713171005249,-1.1471103429794312,-0.6677854061126709,-0.749596893787384,-0.28327617049217224,-0.6842843890190125,0.5430465340614319,-0.5047811269760132,-0.1261013150215149};
    // float input_vector[INPUT_SIZE] =  {-1.019496202468872,0.22259549796581268,-0.8068004250526428,-0.8154550194740295,-0.3847731649875641,-1.0202767848968506,1.1907063722610474,0.1234389990568161,-0.5060392618179321,0.540954053401947,-0.24535058438777924,0.15040233731269836,0.008443083614110947,1.0921690464019775,-1.17437744140625,1.1505601406097412,-0.8225263357162476,-0.03650287538766861,0.26673468947410583,-0.4871925711631775,0.45796218514442444,-1.0787041187286377,-0.9521467685699463,1.5915930271148682,-1.6704989671707153,1.2552354335784912,-1.495684266090393,0.11858385801315308,0.15398944914340973,-0.10101737827062607,0.18301239609718323,-2.0547258853912354,1.3639678955078125,-0.07111717760562897,1.6317973136901855,-0.2480859011411667,-1.0601892471313477,-0.3206120729446411,-0.008121064864099026,-0.16030266880989075,-1.0197144746780396,0.2220618724822998,-0.8067099452018738,-0.8153477907180786,-0.3846853971481323,-0.9502361416816711,1.160744071006775,0.1235293373465538,-0.5060564279556274,0.5408807992935181,-0.2453199028968811,0.15030381083488464,0.008608287200331688,1.092245101928711,-1.174244999885559,1.150506854057312,-0.7930054664611816,-0.031449418514966965,0.27842313051223755,-0.45098307728767395,0.4516565799713135,-1.077693223953247,-0.9573386311531067,1.5913039445877075,-1.6699575185775757,1.2428475618362427,-1.5046679973602295,0.1185845136642456,0.1375998705625534,-0.10100947320461273,0.183925062417984,-2.05069637298584,1.363947868347168,-0.170570969581604,1.5984172821044922,-0.2382006198167801,-1.0745433568954468,-0.3205338418483734,0.01766754314303398,-0.1432015597820282,-1.0199326276779175,0.22197575867176056,-0.8066195249557495,-0.8152406811714172,-0.35086143016815186,-0.8802141547203064,1.1706039905548096,0.12363064289093018,-0.5060735940933228,0.5408074259757996,-0.24529017508029938,0.15020667016506195,0.008774898946285248,1.0923212766647339,-1.179606318473816,1.1413569450378418,-0.8228957056999207,-0.03141525015234947,0.3018587827682495,-0.4328577518463135,0.4579744040966034,-1.0784271955490112,-0.9522627592086792,1.591015338897705,-1.6694157123565674,1.2552279233932495,-1.4953758716583252,0.12521740794181824,0.15398302674293518,-0.10100197792053223,0.1848376840353012,-2.0431153774261475,1.3639278411865234,-0.17059171199798584,1.548424243927002,-0.26328766345977783,-1.0816718339920044,-0.2896142303943634,0.02732749655842781,-0.11470252275466919};
    // float input_vector[INPUT_SIZE] =  {0.8220906853675842,0.8900900483131409,0.023389654234051704,0.8636437058448792,-0.7895514965057373,1.1142269372940063,-0.8800308108329773,0.7021998763084412,0.8999184370040894,-0.08059915155172348,-1.7577344179153442,-1.273871898651123,-0.9460248947143555,-0.33335328102111816,-0.7129392623901367,-1.161286473274231,0.8929222226142883,0.13403445482254028,-0.47319671511650085,1.1216599941253662,-0.8429847359657288,-0.4140986502170563,1.3446300029754639,-1.1451188325881958,0.3357904255390167,-0.7508388161659241,0.5417934656143188,0.07218413054943085,0.2851324677467346,-0.0004364166234154254,-0.684248149394989,-0.10141826421022415,-1.920604944229126,0.6249527931213379,-1.6685924530029297,-1.6271213293075562,0.6523059606552124,-0.12019563466310501,-0.8981902599334717,-1.003813624382019,0.8062810301780701,0.8900466561317444,0.023091573268175125,0.8637335300445557,-0.722020149230957,1.2192150354385376,-0.900041401386261,0.702333390712738,0.7720974087715149,0.002158679533749819,-1.757645845413208,-1.2674657106399536,-0.9443602561950684,-0.33333224058151245,-0.7183136940002441,-1.170579195022583,0.8780819177627563,0.14912201464176178,-0.4850139319896698,1.1217180490493774,-0.6968965530395508,-1.3644143342971802,1.064293622970581,-1.145065188407898,0.21699747443199158,-0.7260786890983582,0.5235252380371094,0.08544185012578964,0.3507072329521179,-0.04415929690003395,-0.6629749536514282,-0.02630733512341976,-1.9010181427001953,0.42606058716773987,-1.6520898342132568,-1.3824750185012817,0.5511873364448547,-0.2896977961063385,-0.8627281188964844,-1.0608044862747192,0.8064076900482178,0.8900031447410583,0.022582799196243286,0.8638232350349426,-0.5195406675338745,1.2542099952697754,-0.8901864886283875,0.7989585399627686,0.7720907926559448,0.250700980424881,-1.7575600147247314,-1.261055588722229,-0.9426958560943604,-0.3333112597465515,-0.7127012014389038,-1.1798899173736572,0.8929473161697388,0.1541740596294403,-0.5320635437965393,1.0856077671051025,-1.1813257932662964,0.3662954270839691,1.1699535846710205,-0.9495810270309448,0.4399090111255646,-0.8994466662406921,0.6240187883377075,0.03241797536611557,0.21955467760562897,-0.044151753187179565,-0.6398505568504333,0.042382098734378815,-1.8814340829849243,0.42604076862335205,-1.7518662214279175,-1.197749376296997,0.46452638506889343,-0.33587318658828735,-0.9046688079833984,-1.0095077753067017};
    // float input_vector[INPUT_SIZE] =  {0.9495802521705627,1.1450979709625244,0.09555726498365402,1.1219666004180908,-1.1605981588363647,1.3941618204116821,-1.0094518661499023,-1.998684287071228,-0.8894822597503662,-1.2822686433792114,0.7486981749534607,-0.902321994304657,1.998669981956482,-1.6638407707214355,0.35825663805007935,-0.21470360457897186,1.1379863023757935,-0.8039208054542542,0.7600222826004028,-0.8487325310707092,-0.35611042380332947,1.3518346548080444,1.4075782299041748,-0.36320117115974426,0.9599694013595581,-0.6641566157341003,1.1448137760162354,0.17824064195156097,-0.288618266582489,-0.04416726902127266,0.5051113367080688,0.7671923637390137,0.8310725688934326,0.12775994837284088,0.5076712369918823,0.7362256050109863,-0.756709098815918,0.6198035478591919,-0.4950792193412781,-0.257192462682724,0.949708878993988,1.1450709104537964,0.09526193141937256,1.1220537424087524,-1.1942888498306274,1.289197325706482,-1.0195071697235107,-1.9987521171569824,-0.8895025849342346,-1.365366816520691,0.7294429540634155,-0.8372460007667542,2.054687738418579,-1.6638710498809814,0.3308776319026947,-0.26945167779922485,1.108320713043213,-0.703576385974884,0.6660141944885254,-1.0294479131698608,-0.6548518538475037,0.7946260571479797,1.5319393873214722,-0.4609728455543518,0.6775928139686584,-0.8994432091712952,1.1539095640182495,0.2577836811542511,-0.23943622410297394,-0.031040027737617493,0.5041735768318176,0.6321431994438171,0.8310899138450623,0.028306223452091217,0.5407565832138062,0.69620680809021,-0.7493972182273865,0.6199657320976257,-0.49509039521217346,-0.17169854044914246,0.9498375654220581,1.1495180130004883,0.0939154103398323,1.1221407651901245,-1.1605217456817627,1.4991439580917358,-1.039519190788269,-2.2400171756744385,-0.889522910118103,-1.3656061887741089,0.7239372730255127,-0.7558693289756775,2.1106984615325928,-1.8539859056472778,0.3254759907722473,-0.3060087263584137,0.9375146627426147,-0.3373868465423584,0.43105801939964294,-0.8124741315841675,-0.6454288959503174,0.8362740874290466,1.5252423286437988,-0.4610047936439514,0.6924338340759277,-0.8870635032653809,1.135596752166748,0.277673602104187,-0.2394467294216156,-0.10974815487861633,0.5023102760314941,0.39410993456840515,0.8214195370674133,-0.07115296274423599,0.7787255644798279,0.6012143492698669,-0.7637618780136108,0.48136794567108154,-0.3822349011898041,-0.20589286088943481};
    //float input_vector[INPUT_SIZE] =  {-1.0072253942489624,0.24228030443191528,-0.8025984764099121,-1.0737779140472412,-0.2161155641078949,-0.9153012037277222,1.0314189195632935,0.1234389990568161,-0.5060392618179321,0.45808035135269165,0.42422300577163696,0.6360244154930115,0.7442663908004761,-1.1886667013168335,0.067111074924469,0.7500827312469482,0.3508107662200928,-0.30234047770500183,-0.9195044636726379,-0.9933484196662903,-0.15234725177288055,-1.2650582790374756,1.1627936363220215,2.471250295639038,-2.6513514518737793,-0.03261471539735794,3.2279746532440186,-0.09352920204401016,-0.07551084458827972,0.04766751825809479,-1.5441040992736816,-2.548739433288574,0.48033061623573303,0.12775994837284088,-0.0017848842544481158,0.5663444399833679,1.9601608514785767,-0.19727887213230133,-0.10809259861707687,0.01637866348028183,-1.0066466331481934,0.24219536781311035,-0.8025078773498535,-1.0736680030822754,-0.18228456377983093,-0.9852272868156433,1.0313228368759155,0.1235293373465538,-0.5060564279556274,0.4580004811286926,0.4448506534099579,0.5968197584152222,0.7892016172409058,-1.283717155456543,0.1605900377035141,0.713596522808075,0.41017746925354004,-0.23710019886493683,-1.0957635641098022,-1.0294479131698608,-0.1520700752735138,-1.258933424949646,1.1653777360916138,2.470851182937622,-2.6357219219207764,-0.03262041136622429,3.227782964706421,-0.09352852404117584,-0.07550747692584991,0.05642177164554596,-1.5441211462020874,-2.526855945587158,0.48231014609336853,0.12774482369422913,-0.018529990687966347,0.5612924098968506,1.9529284238815308,-0.3205338418483734,-0.12422773241996765,0.061976730823516846,-1.0070239305496216,0.2407682240009308,-0.8024172186851501,-1.0735582113265991,-0.2496538609266281,-0.9152047038078308,1.0312268733978271,0.12363064289093018,-0.5060735940933228,0.4579198658466339,0.4723506271839142,0.5543556213378906,0.832728922367096,-1.2837328910827637,0.19913695752620697,0.7681368589401245,0.38785070180892944,-0.2721797823905945,-0.8726798295974731,-1.2824753522872925,-0.15164707601070404,-1.262608528137207,1.1636043787002563,2.4704525470733643,-2.634951591491699,-0.03262358531355858,3.2184500694274902,-0.09352410584688187,-0.1083034798502922,0.056429408490657806,-1.5441384315490723,-2.5049803256988525,0.4775080978870392,0.22716327011585236,-0.018660081550478935,0.5862230062484741,1.9384722709655762,-0.45923033356666565,-0.13391754031181335,0.10187453776597977};

    float input_vector[INPUT_SIZE]  = {1.4595,  0.3886,  0.6103,  1.8969, -0.4522,  0.8693, -1.7561,1.4257,  0.2608,  1.2039, -1.2463, -0.8632,  0.1977,  0.0468,1.2042, -1.5891, -0.4958, -0.2572, -0.0739,  0.0732,  1.4606,1.0262,  0.1577, -0.9496,  0.5884, -0.1688,  0.4047, -0.1200,-0.2067,  0.0783, -1.3497,  1.1475, -1.4458,  1.7188, -2.1116,-2.0418,  0.4644, -0.2127, -0.3209, -0.2743,  1.4437,  0.4153,0.6020,  1.7679, -0.2498,  0.4844, -1.6965,  1.1847,  0.2608,1.3697, -1.2160, -0.8601,  0.1698, -0.1433,  1.1603, -1.5165,-0.3994, -0.2371, -0.1679,  0.3986,  1.4607,  1.0262,  0.1577,-0.9496,  0.5884, -0.1688,  0.4048, -0.1200, -0.2067,  0.0783,-1.3498,  1.2327, -1.4554,  1.5199, -2.1228, -1.8922,  0.4067,-0.4439, -0.3242, -0.4339,  1.4279,  0.4256,  0.5990,  1.7679,-0.2834,  0.2745, -1.6966,  1.0884,  0.7721,  1.2039, -1.2035,-0.8569,  0.1559, -0.1432,  1.1165, -1.4803, -0.4366, -0.2722,-0.2619,  0.8145,  1.4607,  1.0262,  0.1577, -0.9496,  0.5885,-0.1688,  0.4048, -0.1200, -0.2067,  0.0783, -1.3498,  1.2752,-1.4649,  1.6193, -2.1672, -1.8224,  0.3778, -0.5209, -0.4080,-0.4396};



    





//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// LAYER 1
// CONVOLUTION 1
    float conv0_currentKernel[KERNEL_SIZE];
    float conv0_current_bias = 0;
    float conv0_featureMap[NUM_FILTERS][CONV0_INPUT_SIZE-4];
    printf(" Conv0 #################################################################\n");

    for (int k = 0; k < NUM_FILTERS; k++)
    {
        // Load Current Weights
        // printf("CurrKernel = |");
        for (i = 0; i < KERNEL_SIZE; i++)
        {
            conv0_currentKernel[i] = conv0_weights[i + (k * KERNEL_SIZE)];
            // printf("%f|",conv1_currentKernel[i]);
        }
        // printf("");

        // Load Current Bias
        conv0_current_bias = conv0_bias[k];
        


        // Perform Kernel operation
        for (i = 0; i <= sizeof(input_vector)/sizeof(input_vector[0])-KERNEL_SIZE; i++)
        {
            float totalSum = 0;
            for (int j = 0; j < KERNEL_SIZE; j++)
            {
               //printf("%f = %f + %f\n",totalSum,input_vector[i+j],conv0_currentKernel[j]);
               totalSum += input_vector[i+j] * conv0_currentKernel[j];
            }
            // printf("Finished Sum=%f  k=%d  i=%d ",totalSum,k,i);

            conv0_featureMap[k][i] = totalSum + conv0_current_bias;
        }
    }
///// RELU

///// RELU
    for (int i = 0; i < NUM_FILTERS; i++)
    {
        // printf("conv0--------- FILTER %d",i);
        for (int j = 0; j < CONV0_INPUT_SIZE-4; j++)
        {
            
            if (conv0_featureMap[i][j] <= 0)
                conv0_featureMap[i][j] = 0;    
            // printf("%f\n",conv0_featureMap[i][j]);        
        }
    }

    
///////////// PRINT
    // printf("------------------------------------------ DEBUG\n");
    // for( int i = 0 ; i < sizeof(conv0_featureMap[0])/sizeof(conv0_featureMap[0][0]); i++){
    //     printf("%f\n",conv0_featureMap[0][i]);
    // } 
    // printf("------------------------------------------ DEBUG END\n");




//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// LAYER 3
// CONVOLUTION 3
    float conv3_featureMap[NUM_FILTERS][CONV3_INPUT_SIZE-4]; // 112
    printf(" Conv3   #####################################################################\n");



    float conv3_totalSum = 0;
    for (int filterToGenerate = 0 ; filterToGenerate < NUM_FILTERS ; filterToGenerate ++ ){
        // printf("\n------------ Generating Filter %d",filterToGenerate);
        for (int inputOffset = 0 ; inputOffset < CONV3_INPUT_SIZE-4 ; inputOffset++){
            // printf("\n--- InputOffset %d",inputOffset);
            conv3_totalSum = 0;
            for (int filterIn = 0 ; filterIn < NUM_FILTERS ; filterIn++){
                // printf("\n--- Filter In %d",filterIn);
                for (int kernelIndex = 0 ; kernelIndex < KERNEL_SIZE ; kernelIndex++){
                    int weightIndex = kernelIndex + (filterIn * KERNEL_SIZE) + ( filterToGenerate * NUM_FILTERS * KERNEL_SIZE ) ;
                    int indexIn = kernelIndex + (inputOffset);
                    conv3_totalSum += conv0_featureMap[filterIn][indexIn] * conv3_weights[weightIndex]; 

                    // if(filterToGenerate == 0)                                  //0-5  //linha    // offset outro filtro
                    //     printf("\n%f[%d][%d] * %f[%d]",conv0_featureMap[filterIn][indexIn],filterIn,indexIn, conv3_weights[weightIndex],weightIndex );
                }
            }
            conv3_totalSum += conv3_bias[filterToGenerate];
            // printf("filters[%d][%d] = %f",filterToGenerate,inputOffset,conv3_totalSum);
            conv3_featureMap[filterToGenerate][inputOffset] = conv3_totalSum;
        }
    }
    
    

    
///// RELU
    for (int i = 0; i < NUM_FILTERS; i++)
    {
        // printf("--------- FILTER %d",i);
        for (int j = 0; j < CONV3_INPUT_SIZE-4; j++)
        {
            if (conv3_featureMap[i][j] <= 0)
                conv3_featureMap[i][j] = 0;        
            // printf("\n%f",conv3_featureMap[i][j]);    
        }
    }


///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// LAYER 6
// CONVOLUTION 6

    float conv6_featureMap[NUM_FILTERS][CONV6_INPUT_SIZE-4]; 
    printf(" Conv6  ##########################################################\n");


    float totalSum = 0;
    for (int filterToGenerate = 0 ; filterToGenerate < NUM_FILTERS ; filterToGenerate ++ ){
        // printf("\n------------ Generating Filter %d",filterToGenerate);
        for (int inputOffset = 0 ; inputOffset < CONV6_INPUT_SIZE-4 ; inputOffset++){
            // printf("\n--- InputOffset %d",inputOffset);
            totalSum = 0;
            for (int filterIn = 0 ; filterIn < NUM_FILTERS ; filterIn++){
                // printf("\n--- Filter In %d",filterIn);
                for (int kernelIndex = 0 ; kernelIndex < KERNEL_SIZE ; kernelIndex++){
                    int weightIndex = kernelIndex + (filterIn * KERNEL_SIZE) + ( filterToGenerate * NUM_FILTERS * KERNEL_SIZE ) ;
                    int indexIn = kernelIndex + (inputOffset);
                    totalSum += conv3_featureMap[filterIn][indexIn] * conv6_weights[weightIndex]; 

                    // if(filterToGenerate == 0)                                  //0-5  //linha    // offset outro filtro
                    //     printf("\n%f[%d][%d] * %f[%d]",conv0_featureMap[filterIn][indexIn],filterIn,indexIn, conv3_weights[weightIndex],weightIndex );
                }
            }
            totalSum += conv6_bias[filterToGenerate];
            // printf("filters[%d][%d] = %f",filterToGenerate,inputOffset,totalSum);
            conv6_featureMap[filterToGenerate][inputOffset] = totalSum;
        }
    }
    
    
/////////////////////////// RELU
    for (int i = 0; i < NUM_FILTERS; i++)
    {
        // printf("\n------ Filter %d\n",i);
        for (int j = 0; j < CONV6_INPUT_SIZE-4; j++)
        {
            if (conv6_featureMap[i][j] <= 0)
                conv6_featureMap[i][j] = 0;            
            // printf("%f   ",conv6_featureMap[i][j]);
            // if((j+1) % 5 == 0) printf("\n");
        }
    }







///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////// LAYER 2
////////////////////////////////////////// FC Layer
///// Flatten

    float flatten1_vector[NUM_FILTERS*(CONV6_INPUT_SIZE-4)];
    int index = 0;

    printf(" Flatten 1  ######################################################################\n");
    for (int k = 0; k < NUM_FILTERS; k++)
    {
        for (int i = 0; i < CONV6_INPUT_SIZE-4; i++)
        {
            flatten1_vector[index] =  conv6_featureMap[k][i];
            // printf("%f\n",flatten1_vector[index]);
            index++;
        }
    }
    
/////// FC 1 (6192 > 128)

    float fc1_out_vector[FC1_OUTPUT_SIZE];
    float totalValue;
    int fc1_inputSize = NUM_FILTERS*(CONV6_INPUT_SIZE-4); // 6912

    printf(" FC 1  #########################################################################\n");

    for (int outputIndex = 0; outputIndex < FC1_OUTPUT_SIZE; outputIndex++){
        totalValue = 0;
        for (int i = 0; i < fc1_inputSize; i++)
        {
            totalValue += flatten1_vector[i] * fc1_weights[(fc1_inputSize*outputIndex)+i];
        }
        fc1_out_vector[outputIndex] = totalValue + fc1_bias[outputIndex];
    }


    
////////////////// RELU
  printf(" RELU FC 1  #########################################################################\n");
    for (int i = 0; i < FC1_OUTPUT_SIZE ; i++){
    
        if ( fc1_out_vector[i] < 0) fc1_out_vector[i] = 0;
        
        printf("%f",fc1_out_vector);
        if((i+1) % 5 == 0) printf("\n");
    }



///////////////// FC 1 (128 > 5)
    float fc2_out_vector[FC2_OUTPUT_SIZE];
    float fc2_totalValue;
    

    printf(" FC 2 ################################################################### \n");

    for (int outputIndex = 0; outputIndex < FC2_OUTPUT_SIZE; outputIndex++){
        fc2_totalValue = 0;
        for (int i = 0; i < FC1_OUTPUT_SIZE; i++)
        {
            fc2_totalValue += fc1_out_vector[i] * fc2_weights[(FC1_OUTPUT_SIZE*outputIndex)+i];
            // printf("\n%f = %f * %f [%d]",fc1_out_vector[i]*fc2_weights[(FC1_OUTPUT_SIZE*outputIndex)+i],fc1_out_vector[i],fc2_weights[(FC1_OUTPUT_SIZE*outputIndex)+i],(FC1_OUTPUT_SIZE*outputIndex)+i);
        }
        fc2_out_vector[outputIndex] = fc2_totalValue + fc2_bias[outputIndex];
    }


    

////////////////////////// Result Classes
    printf("\n############################################################## RESULT CLASSES");
    for (int i = 0; i < 5; i++){
        printf("\n%f",fc2_out_vector[i]);
    }




    printf(" \n------------------------------------------------------------- End..");
    return 0;
}
